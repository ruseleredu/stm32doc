"use strict";(self.webpackChunkstm_32_doc=self.webpackChunkstm_32_doc||[]).push([[7459],{501:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/processing-57b069e46941e05f274ba8d9951e3c89.png"},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(96540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}},34123:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/severalProbesSeveralProcessings-3503da397f53b20700a4ca5371f24aad.png"},48367:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/severalProbesOnOneProcessing-318219844e3c22243a56ea557899c156.png"},94318:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"software/stm32cubemon/node-red-contrib-stm32cubemonitor-processing","title":"processing","description":"Transform each input message representing one measurement of a group of variables into one message every 50 ms per variable containing one or several duplets (x and y).","source":"@site/docs/software/stm32cubemon/processing.md","sourceDirName":"software/stm32cubemon","slug":"/node-red-contrib-stm32cubemonitor-processing","permalink":"/stm32doc/docs/node-red-contrib-stm32cubemonitor-processing","draft":false,"unlisted":false,"editUrl":"https://github.com/ruseleredu/stm32doc/edit/main/docs/software/stm32cubemon/processing.md","tags":[],"version":"current","frontMatter":{"id":"node-red-contrib-stm32cubemonitor-processing","title":"processing","description":"Transform each input message representing one measurement of a group of variables into one message every 50 ms per variable containing one or several duplets (x and y).","slug":"/node-red-contrib-stm32cubemonitor-processing"},"sidebar":"tutorialSidebar","previous":{"title":"Node-RED","permalink":"/stm32doc/docs/node-red"},"next":{"title":"radar","permalink":"/stm32doc/docs/node-red-contrib-stm32cubemonitor-radar"}}');var r=s(74848),o=s(28453);const t={id:"node-red-contrib-stm32cubemonitor-processing",title:"processing",description:"Transform each input message representing one measurement of a group of variables into one message every 50 ms per variable containing one or several duplets (x and y).",slug:"/node-red-contrib-stm32cubemonitor-processing"},a=void 0,l={},d=[{value:"Properties",id:"properties",level:3},{value:"Input",id:"input",level:3},{value:"Output",id:"output",level:3},{value:"Details",id:"details",level:3}];function c(e){const n={br:"br",code:"code",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'<script type="text/x-red" data-help-name="processing">\n'})}),"\n",(0,r.jsx)(n.p,{children:"Transform each input message representing one measurement of a group of variables into one message every 50 ms per variable containing one or several duplets (x and y). It is also possible to define expressions and statistics based on those individual measurements and log options."}),"\n",(0,r.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(n.p,{children:"Group NamePick List"}),"\n",(0,r.jsx)(n.p,{children:"Name of the variables nodes to be processed."}),"\n",(0,r.jsx)(n.p,{children:"Log dataPick List"}),"\n",(0,r.jsxs)(n.p,{children:["The acquisition is recorded in the file system on server side under a predefined directory path.",(0,r.jsx)(n.br,{}),"\n",'The recorded data are stored in at least one file. If needed several files of maximum 100MB size each are created to store all the data for a single acquisition.The log files names follow the following convention : "Log_groupname_timestamp.extension". Extension depends on choosen log format.',(0,r.jsx)(n.br,{}),"\n","The number of generated files for one acquisition will be therefore related to :"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Number of monitored variables."}),"\n",(0,r.jsx)(n.li,{children:"Acquisition frequency."}),"\n",(0,r.jsx)(n.li,{children:"Log type ( all values or only changes )."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For example :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"1 generated file for an acquisition of 1 variable during 25 hours at 10 Hz."}),"\n",(0,r.jsx)(n.li,{children:"4 generated files for an acquisition of 10 variables during 2 hours with an ST LINK V3 in sequential loop."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The directory path where you can find the log files could be configured in settings.js file ( default path is home directory / log )."}),"\n",(0,r.jsx)(n.p,{children:"Log mode selection:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"No log"})," Values are not logged."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Log all values"})," All the values read are logged."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Log only changes"})," Only the changes for each variable are logged."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Log format selection:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"stcm"})," Log in a proprietary json like format."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"csv (one column)"})," Log in a csv (comma-separated values) format."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"csv (multiple columns)"})," Log in a csv format with variables organized in columns."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"OutputsList"}),"\n",(0,r.jsx)(n.p,{children:'List summarizing the variables and post-processing data which will have there specific messages sent on the node output. From this list it is possible to remove (by using the "cross" button) or edit (by clicking on the line) a post-processing output.'}),"\n",(0,r.jsx)(n.p,{children:"Post-processingExpression | Statistic"}),"\n",(0,r.jsx)(n.p,{children:"It is possible to add some outputs by doing some post processing calculation on variables."}),"\n",(0,r.jsx)(n.p,{children:"Expression"}),"\n",(0,r.jsx)(n.p,{children:'Expression variables are the result of a mathematical expression evaluation. An expression is the combination of standard (coming from "variables" node) or statistical variables and mathematical operators (+,-,*, /\u2026). Note that expression variables are evaluated after statistical variables, thus it is not possible to compute statistics on expressions.'}),"\n",(0,r.jsx)(n.p,{children:"Expression name string"}),"\n",(0,r.jsx)(n.p,{children:"The name of the expression to be addedd in output list"}),"\n",(0,r.jsx)(n.p,{children:"Formula string"}),"\n",(0,r.jsx)(n.p,{children:'A string representing a mathematical formula. The validity of the formula is checked once "+ add" button is clicked.'}),"\n",(0,r.jsx)(n.p,{children:"Possible variables in formula Pick List"}),"\n",(0,r.jsx)(n.p,{children:'The "Possible variables in formula" field could be used to write out the formula. By clicking on a line, the corresponding variable is automatically inserted in formula field.'}),"\n",(0,r.jsx)(n.p,{children:"Operations Pick List"}),"\n",(0,r.jsxs)(n.p,{children:["The first field allows to select the operation category among ",(0,r.jsx)(n.code,{children:"Mathematical"}),", ",(0,r.jsx)(n.code,{children:"Trigonometry"}),", or ",(0,r.jsx)(n.code,{children:"Logical"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"The second field is the list of operations. By clicking on a line, the corresponding operation is automatically inserted in formula field."}),"\n",(0,r.jsx)(n.p,{children:"Statistic"}),"\n",(0,r.jsx)(n.p,{children:'Statistical variables can compute values like min, max, average and standard deviation of standard variables (coming from "variables" node).'}),"\n",(0,r.jsx)(n.p,{children:"Statistic name string"}),"\n",(0,r.jsx)(n.p,{children:'The name of the statistic to be added in output list and in "Possible variables in formula" field'}),"\n",(0,r.jsx)(n.p,{children:"Variable string"}),"\n",(0,r.jsx)(n.p,{children:'A string representing a mathematical formula. The validity of the formula is checked once "+ add" button is clicked.'}),"\n",(0,r.jsx)(n.p,{children:"Possible variables in formula Pick List"}),"\n",(0,r.jsx)(n.p,{children:'The "Possible variables in formula" field could be used to write out the formula. By clicking on a line, the corresponding variable is automatically inserted in formula field.'}),"\n",(0,r.jsx)(n.p,{children:"Operations Pick List"}),"\n",(0,r.jsxs)(n.p,{children:["The first field allows to select the operation category among ",(0,r.jsx)(n.code,{children:"Mathematical"}),", ",(0,r.jsx)(n.code,{children:"Bitwise"}),", ",(0,r.jsx)(n.code,{children:"Trigonometry"})," or ",(0,r.jsx)(n.code,{children:"Logical"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"The second field is the list of operations. By clicking on a line, the corresponding operation is automatically inserted in formula field."}),"\n",(0,r.jsx)(n.h3,{id:"input",children:"Input"}),"\n",(0,r.jsx)(n.p,{children:"payloadobject"}),"\n",(0,r.jsx)(n.p,{children:"payload is an object representing the variables measurement. The payload object holds several properties:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"first"})," boolean, true when this is the first measurement after a start to allow creation of a new log file."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"groupname"}),' string, representing the name of the selected "variables" node']}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"data"}),' array of duplet, each representing a target memory access. The index of the duplets in the array, is the same as the order of the variables in "Variable list" field of "variables" node']}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"x"})," number, the value read from memory target"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"y"})," number, the timestamp at which the value has been read"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The following example shows an input ",(0,r.jsx)(n.code,{children:"msg"})," for processing node:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'        {\r\n          "payload": {\r\n            "data": \\[\r\n              \\[\r\n                {\r\n                  "y": 0,\r\n                  "x": 1559722981321\r\n                }\r\n              \\],\r\n              \\[\r\n                {\r\n                  "y": 0,\r\n                  "x": 1559722981321\r\n                }\r\n              \\],\r\n              \\[\r\n                {\r\n                  "y": 463,\r\n                  "x": 1559722981321\r\n                }\r\n              \\],\r\n              \\[\r\n                {\r\n                  "y": 2048,\r\n                  "x": 1559722981321\r\n                }\r\n              \\]\r\n            \\],\r\n            "first": true,\r\n            "groupname": "nv\\_group2"\r\n          },\r\n        }\n'})}),"\n",(0,r.jsx)(n.p,{children:"topicobject"}),"\n",(0,r.jsxs)(n.p,{children:["A message with ",(0,r.jsx)(n.code,{children:"topic"})," set to ",(0,r.jsx)(n.code,{children:"clear"})," will reset the log timestamp to zero."]}),"\n",(0,r.jsx)(n.h3,{id:"output",children:"Output"}),"\n",(0,r.jsxs)(n.p,{children:["Two outputs are defined, one port labelled ",(0,r.jsx)(n.code,{children:"data"})," for the measurement and one labelled ",(0,r.jsx)(n.code,{children:"error"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"error"})," output ",(0,r.jsx)(n.code,{children:"msg.payload"})," is the error message string, the ",(0,r.jsx)(n.code,{children:"msg.topic"})," defines the error level."]}),"\n",(0,r.jsxs)(n.p,{children:["for ",(0,r.jsx)(n.code,{children:"data"})," output ",(0,r.jsx)(n.code,{children:"msg.payload"})," is an object representing the variable measurements."]}),"\n",(0,r.jsxs)(n.p,{children:["For each variable, expression, and statistic, the ",(0,r.jsx)(n.code,{children:"msg"})," object holds:"]}),"\n",(0,r.jsx)(n.p,{children:"topicstring"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"topic"})," value is set to ",(0,r.jsx)(n.code,{children:"data"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"payloadobject"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"payload"})," is an object representing a set of measurement for a single variable from one group :"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"groupname"})," string, the name of the group the ",(0,r.jsx)(n.code,{children:"variabledata"})," is referring to."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"variablename"})," string, the variable name the ",(0,r.jsx)(n.code,{children:"variabledata"})," is referring to."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"variabledata"})," array of duplets"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"each duplet object represents a single measurement and holds :"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"x"})," number, representing the timestamp"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"y"})," number, representing the read value in memory target"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The following example shows an output ",(0,r.jsx)(n.code,{children:"msg"})," for a processing node :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'        {\r\n          "topic":"data",\r\n          "payload":\r\n          {\r\n            "groupname": "groupname1",\r\n            "variablename": "var1",\r\n            "variabledata": \\[\r\n              {\r\n                "x": "0",\r\n                "y": "1231"\r\n              },\r\n              {\r\n                "x": "1",\r\n                "y": "12"\r\n              },\r\n              {\r\n                "x": "2",\r\n                "y": "1565"\r\n              }\r\n            \\]\r\n          }\r\n        }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"details",children:"Details"}),"\n",(0,r.jsx)(n.p,{children:"The processing node is designed to be typically :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"front linked with an acquisition in node"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Warning: front link ",(0,r.jsx)(n.code,{children:"processing"})," node with only one ",(0,r.jsx)(n.code,{children:"acquisition"})," in node !"]})," Using the same ",(0,r.jsx)(n.code,{children:"variable"})," node to send configuration to several ",(0,r.jsx)(n.code,{children:"acquisition out"})," nodes and linking the different ",(0,r.jsx)(n.code,{children:"acquisition in"})," nodes to only one ",(0,r.jsx)(n.code,{children:"processing"})," node leads to mixing the data coming from different probes as there is no discriminating information."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{alt:"Don&#39;t",src:s(48367).A+"",width:"383",height:"183"})," ",(0,r.jsx)(n.img,{alt:"Do",src:s(34123).A+"",width:"392",height:"183"}),"*   back linked with a STChart node or a 'single value' subflow node."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"basic flow for variables node",src:s(501).A+"",width:"806",height:"204"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);